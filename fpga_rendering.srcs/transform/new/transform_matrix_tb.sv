`default_nettype none
`timescale 1ns / 1ps

import Utils::mat4f;

module transform_matrix_tb;

    logic clk;

    mat4f mat_rotation, mat_translation, mat_perspective_proj;
    mat4f mat_tr;

    // Start matrix transformation flag
    logic mtr_start;
    // Matrix transformation busy flag
    logic mtr_busy, mtr_done;

    // Transformed matrix
    mat4f mat_tr;

    transform_matrix mt (
        .clk,
        .start(mtr_start),
        .mat_translation,
        .mat_proj(mat_perspective_proj),
        .mat_rotation,
        .mat_tr,
        .busy(mtr_busy),
        .done(mtr_done)
    );

    initial begin
        clk = 0;
        forever begin
            #5 clk = ~clk;
        end
    end

    initial begin
        mat_rotation = {
            32'b0000000000000001_0000000000000000, 32'b0000000000000000_0000000000000000, 32'b0000000000000000_0000000000000000, 32'b0000000000000000_0000000000000000, 
            32'b0000000000000000_0000000000000000, 32'b0000000000000001_0000000000000000, 32'b0000000000000000_0000000000000000, 32'b0000000000000000_0000000000000000, 
            32'b0000000000000000_0000000000000000, 32'b0000000000000000_0000000000000000, 32'b0000000000000001_0000000000000000, 32'b0000000000000000_0000000000000000, 
            32'b0000000000000000_0000000000000000, 32'b0000000000000000_0000000000000000, 32'b0000000000000000_0000000000000000, 32'b0000000000000001_0000000000000000
        };

        mat_translation = {
            32'b0000000000000001_0000000000000000, 32'b0000000000000000_0000000000000000, 32'b0000000000000000_0000000000000000, 32'b0000000000000000_0000000000000000, 
            32'b0000000000000000_0000000000000000, 32'b0000000000000001_0000000000000000, 32'b0000000000000000_0000000000000000, 32'b0000000000000000_0000000000000000, 
            32'b0000000000000000_0000000000000000, 32'b0000000000000000_0000000000000000, 32'b0000000000000001_0000000000000000, 32'b0000000000000011_0000000000000000, 
            32'b0000000000000000_0000000000000000, 32'b0000000000000000_0000000000000000, 32'b0000000000000000_0000000000000000, 32'b0000000000000001_0000000000000000
        };

        mat_perspective_proj = {
            32'b0000000000000000_1100000000000000, 32'b0000000000000000_0000000000000000, 32'b0000000000000000_0000000000000000, 32'b0000000000000000_0000000000000000, 
            32'b0000000000000000_0000000000000000, 32'b0000000000000001_0000000000000000, 32'b0000000000000000_0000000000000000, 32'b0000000000000000_0000000000000000, 
            32'b0000000000000000_0000000000000000, 32'b0000000000000000_0000000000000000, 32'b0000000000000001_0001000010000100, 32'b1111111111111101_1110111101111011, 
            32'b0000000000000000_0000000000000000, 32'b0000000000000000_0000000000000000, 32'b0000000000000001_0000000000000000, 32'b0000000000000000_0000000000000000
        };

        mtr_start = 1'b1;

        #10

        mtr_start = 1'b0;
    end

endmodule
